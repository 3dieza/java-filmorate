# Filmorate: ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ER-–¥–∏–∞–≥—Ä–∞–º–º–∞

![ER-–¥–∏–∞–≥—Ä–∞–º–º–∞](src/main/resources/db/er_diagram.png)

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ö–µ–º—ã

–ü—Ä–æ–µ–∫—Ç Filmorate —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∏–ª—å–º–∞—Ö, –∂–∞–Ω—Ä–∞—Ö, —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∏—Ö –¥—Ä—É–∂–±–µ –∏ –ª–∞–π–∫–∞—Ö. –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –¢–∞–±–ª–∏—Ü—ã:

- **film** ‚Äî —Ñ–∏–ª—å–º—ã —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.
- **genre** ‚Äî —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤.
- **film_genre** ‚Äî —Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É —Ñ–∏–ª—å–º–∞–º–∏ –∏ –∂–∞–Ω—Ä–∞–º–∏.
- **rating** ‚Äî —Ä–µ–π—Ç–∏–Ω–≥–∏ MPA (G, PG, PG-13, R, NC-17).
- **user** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã.
- **film_likes** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ç–∞–≤—è—Ç –ª–∞–π–∫–∏ —Ñ–∏–ª—å–º–∞–º (many-to-many).
- **user_friends** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∂–±—ã –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å —Ñ–ª–∞–≥–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

---

## –ü—Ä–∏–º–µ—Ä—ã SQL-–∑–∞–ø—Ä–æ—Å–æ–≤

### üîù –¢–æ–ø-10 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–∞–π–∫–æ–≤:
```sql
SELECT f.*
FROM film f
JOIN film_likes fl ON f.id = fl.film_id
GROUP BY f.id
ORDER BY COUNT(fl.user_id) DESC
LIMIT 10;
```

### üë• –û–±—â–∏–µ –¥—Ä—É–∑—å—è –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
```sql
SELECT f.friend_id
FROM user_friends f
JOIN user_friends f2 ON f.friend_id = f2.friend_id
WHERE f.user_id = 1 AND f2.user_id = 2
  AND f.status = 'confirmed' AND f2.status = 'confirmed';
```

### üé• –§–∏–ª—å–º—ã –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –∂–∞–Ω—Ä–∞:
```sql
SELECT f.*
FROM film f
JOIN film_genre fg ON f.id = fg.film_id
JOIN genre g ON fg.genre_id = g.id
WHERE g.name = '–ö–æ–º–µ–¥–∏—è';
```

### üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ —É –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å–º–∞:
```sql
SELECT f.name, COUNT(fl.user_id) AS like_count
FROM film f
LEFT JOIN film_likes fl ON f.id = fl.film_id
GROUP BY f.id, f.name;
```

---

## üìå –ó–∞–º–µ—Ç–∫–∏

- ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑ dbdiagram.io.
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ 3–ù–§.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–∏—Å–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏–ª–∏ –æ—Ç–∑—ã–≤—ã).
